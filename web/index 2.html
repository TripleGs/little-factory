<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Little Factory</title>
    <!-- External Libraries -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Patrick+Hand&display=swap" rel="stylesheet">
    <!-- Local Styles -->
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <!-- Menu Overlay -->
    <div id="menu-overlay" class="menu-overlay">
        <div class="menu-container">
            <h1 class="menu-title"><i class="fa-solid fa-cube"></i> Little Factory</h1>
            <p class="menu-subtitle">Build. Automate. Profit.</p>

            <!-- Main Menu Screen -->
            <div id="menu-main" class="menu-screen active">
                <div class="menu-buttons">
                    <button id="btn-single-player" class="menu-btn primary">
                        <i class="fa-solid fa-user"></i> Single Player
                    </button>
                    <button id="btn-host-game" class="menu-btn secondary">
                        <i class="fa-solid fa-tower-broadcast"></i> Host Game
                    </button>
                    <button id="btn-join-game" class="menu-btn secondary">
                        <i class="fa-solid fa-right-to-bracket"></i> Join Game
                    </button>
                </div>
            </div>

            <!-- Host Game Screen -->
            <div id="menu-host" class="menu-screen">
                <div class="name-input-section">
                    <label>Your Name</label>
                    <input type="text" class="player-name-input" placeholder="Enter your name" maxlength="20">
                </div>

                <div id="room-code-container" class="room-code-container hidden">
                    <label>Room Code</label>
                    <div class="room-code-display-wrapper">
                        <span id="room-code-display" class="room-code-display">-----</span>
                        <button id="btn-copy-code" class="copy-btn"><i class="fa-solid fa-copy"></i> Copy</button>
                    </div>
                </div>

                <div id="host-status" class="status-message info">Enter your name and create a room</div>

                <div class="menu-buttons">
                    <button id="btn-create-room" class="menu-btn primary">
                        <i class="fa-solid fa-plus"></i> Create Room
                    </button>
                    <button id="btn-host-back" class="menu-btn back">
                        <i class="fa-solid fa-arrow-left"></i> Back
                    </button>
                </div>
            </div>

            <!-- Join Game Screen -->
            <div id="menu-join" class="menu-screen">
                <div class="name-input-section">
                    <label>Your Name</label>
                    <input type="text" class="player-name-input" placeholder="Enter your name" maxlength="20">
                </div>

                <div class="room-code-input-section">
                    <label>Room Code</label>
                    <input type="text" id="join-room-code" class="room-code-input" placeholder="XXXXX" maxlength="5">
                </div>

                <div id="join-status" class="status-message info">Enter the room code shared by the host</div>

                <div class="menu-buttons">
                    <button id="btn-join-room" class="menu-btn primary">
                        <i class="fa-solid fa-right-to-bracket"></i> Join Room
                    </button>
                    <button id="btn-join-back" class="menu-btn back">
                        <i class="fa-solid fa-arrow-left"></i> Back
                    </button>
                </div>
            </div>

            <!-- Lobby Screen -->
            <div id="menu-lobby" class="menu-screen">
                <div id="lobby-room-code-container" class="room-code-container lobby hidden">
                    <label>Room Code</label>
                    <div class="room-code-display-wrapper">
                        <span id="lobby-room-code-display" class="room-code-display">-----</span>
                        <button id="btn-copy-code-lobby" class="copy-btn"><i class="fa-solid fa-copy"></i> Copy</button>
                    </div>
                </div>
                <div class="lobby-players">
                    <h3><i class="fa-solid fa-users"></i> Players</h3>
                    <div id="player-list" class="player-list">
                        <!-- Players added dynamically -->
                    </div>
                </div>

                <p id="lobby-waiting" class="lobby-waiting">Waiting for players...</p>

                <div class="menu-buttons">
                    <button id="btn-start-game" class="menu-btn start">
                        <i class="fa-solid fa-play"></i> Start Game
                    </button>
                    <button id="btn-lobby-back" class="menu-btn back">
                        <i class="fa-solid fa-arrow-left"></i> Leave
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div class="app-container">
        <header>
            <h1><i class="fa-solid fa-cube"></i> Little Factory</h1>
            <div class="stats">
                <div class="money-stack">
                    <div class="money-display">
                        <i class="fa-solid fa-coins"></i>
                        <span id="money-count">0</span>
                    </div>
                    <div class="money-rate" id="money-rate">$0.0/s</div>
                </div>
            </div>
            <p>Place producers and belts. Feed the sellers.</p>
        </header>

        <div class="game-main-area">
            <!-- Player Sidebar (multiplayer only) -->
            <div id="player-sidebar" class="player-sidebar hidden">
                <div class="sidebar-header">
                    <i class="fa-solid fa-users"></i> Players
                </div>
                <div id="sidebar-player-list" class="sidebar-player-list">
                    <!-- Players added dynamically -->
                </div>
                <div id="transfer-section" class="transfer-section">
                    <div class="transfer-header">Send Money</div>
                    <div class="transfer-controls">
                        <select id="transfer-target" class="transfer-select">
                            <option value="">Select player...</option>
                        </select>
                        <div class="transfer-amount-row">
                            <input type="number" id="transfer-amount" class="transfer-input" placeholder="$" min="1">
                            <button id="btn-send-money" class="transfer-btn">
                                <i class="fa-solid fa-paper-plane"></i>
                            </button>
                        </div>
                    </div>
                </div>
                <div class="emote-section">
                    <div class="emote-header">Emote</div>
                    <div class="emote-buttons">
                        <button class="emote-btn" data-emote="thumbs-up" title="Thumbs up">
                            <i class="fa-solid fa-thumbs-up"></i>
                        </button>
                        <button class="emote-btn" data-emote="face-laugh" title="Laugh">
                            <i class="fa-solid fa-face-laugh"></i>
                        </button>
                        <button class="emote-btn" data-emote="heart" title="Love">
                            <i class="fa-solid fa-heart"></i>
                        </button>
                        <button class="emote-btn" data-emote="bolt" title="Wow">
                            <i class="fa-solid fa-bolt"></i>
                        </button>
                        <button class="emote-btn" data-emote="face-angry" title="Angry">
                            <i class="fa-solid fa-face-angry"></i>
                        </button>
                        <button class="emote-btn" data-emote="poo" title="Poop">
                            <i class="fa-solid fa-poo"></i>
                        </button>
                        <button class="emote-btn" data-emote="arrow-up" title="Up">
                            <i class="fa-solid fa-arrow-up"></i>
                        </button>
                        <button class="emote-btn" data-emote="arrow-down" title="Down">
                            <i class="fa-solid fa-arrow-down"></i>
                        </button>
                        <button class="emote-btn" data-emote="arrows-left-right" title="Side to Side">
                            <i class="fa-solid fa-arrows-left-right"></i>
                        </button>
                        <button class="emote-btn" data-emote="face-surprise" title="Surprised">
                            <i class="fa-solid fa-face-surprise"></i>
                        </button>
                        <button class="emote-btn" data-emote="face-grin-squint" title="Goofy">
                            <i class="fa-solid fa-face-grin-squint"></i>
                        </button>
                        <button class="emote-btn" data-emote="skull" title="Skull">
                            <i class="fa-solid fa-skull"></i>
                        </button>
                        <button class="emote-btn" data-emote="" title="Clear">
                            <i class="fa-solid fa-xmark"></i>
                        </button>
                    </div>
                </div>
            </div>

            <div class="game-wrapper">
                <div id="grid-container" class="grid-container">
                    <!-- Grid generated by JS -->
                </div>

                <div class="controls-overlay">
                    <div class="sub-palette" id="sub-palette"></div>
                    <div class="palette-container">
                        <div class="palette" id="palette">
                            <!-- Tools generated by JS -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="join-request-modal" class="join-request-modal hidden">
        <div class="join-request-card">
            <div class="join-request-title">Join Request</div>
            <div class="join-request-message">
                <span id="join-request-name" class="join-request-name">Player</span>
                wants to join your game.
            </div>
            <div class="join-request-actions">
                <button id="btn-accept-join" class="join-request-btn accept">
                    <i class="fa-solid fa-check"></i> Accept
                </button>
                <button id="btn-deny-join" class="join-request-btn deny">
                    <i class="fa-solid fa-xmark"></i> Deny
                </button>
            </div>
        </div>
    </div>

    <!-- PeerJS for WebRTC connections -->
    <script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>

    <script src="colorConfig.js"></script>
    <script src="colorSystem.js"></script>
    <script src="js/core/icons.js"></script>
    <script src="js/core/config.js"></script>
    <script src="js/core/dom.js"></script>
    <script src="js/core/state.js"></script>
    <script src="js/core/baseTools.js"></script>
    <script src="js/core/factories.js"></script>
    <script src="js/core/utils.js"></script>
    <script src="js/core/costs.js"></script>
    <script src="js/core/buttonUtils.js"></script>
    <script src="js/objects/belt.js"></script>
    <script src="js/objects/jumper.js"></script>
    <script src="js/objects/stopper.js"></script>
    <script src="js/objects/packager.js"></script>
    <script src="js/objects/colorer.js"></script>
    <script src="js/objects/seller.js"></script>
    <script src="js/objects/producer.js"></script>
    <script src="js/ui/floatingText.js"></script>
    <script src="js/ui/tooltip.js"></script>
    <script src="js/ui/grid.js"></script>
    <script src="js/ui/expansionButtons.js"></script>
    <script src="js/ui/zoom.js"></script>
    <script src="js/ui/speed.js"></script>
    <script src="js/ui/palette.js"></script>
    <script src="js/ui/renderCells.js"></script>
    <script src="js/ui/renderItems.js"></script>
    <script src="js/ui/controls.js"></script>
    <script src="js/game/movement.js"></script>
    <script src="js/game/loop.js"></script>
    <!-- Network/Multiplayer -->
    <script src="js/network/protocol.js"></script>
    <script src="js/network/peer-manager.js"></script>
    <script src="js/network/game-room.js"></script>
    <script src="js/network/sync.js"></script>
    <script src="js/menu/lobby.js"></script>
    <script src="js/menu/menu.js"></script>
    <!-- Init must be last -->
    <script src="js/game/init.js"></script>
</body>

</html>
